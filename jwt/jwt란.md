# JWT란

## JSON Web Token 이란 무엇인가?

JWT(JSON Web Token)는 당사자 간에 정보를 JSON 개체로 안전하게 전송하기 위한 간결하고 독립적인 방법을 정의하는 개방형 표준(RFC 7519) 입니다. 이 정보는 디지털 서명되어 있으므로 검증되고
신뢰할 수 있습니다.

## JSON Web Token 은 언제 사용해야 하는가?

### 권한 부여

JWT를 사용하는 가장 일반적인 시나리오 입니다. 사용자가 로그인하면 요청에 JWT가 포함되어 해당 토큰으로 허용되는 경로, 서비스 및 리소스에 접근할 수 있습니다.

### 정보 교환

JWT는 당사자 간에 정보를 안전하게 전송하는 좋은 방법입니다. 예를 들어 공개/개인 키 쌍을 사용하여 JWT에 서명할 수 있기 때문에 발신자가 누구인지 확인할 수 있습니다. 또한 Header와 Payload 를
사용하여 서명을 계산하므로 콘텐츠가 변조되지 않았는지 확인할 수도 있습니다.

## JSON Web Token의 구조

JWT는 `.` 으로 구분된 세 부분으로 구성되며 다음과 같습니다.

- Header
- Payload
- Signature

따라서 JWT는 일반적으로 아래와 같이 구성됩니다

```
xxxxx.yyyyy.zzzzz
```

### Header

`Header` 는 일반적으로 JWT 토큰 유형과 사용중인 `Signature` 알고리즘의 두 부분으로 구성됩니다.

```
{
    "alg" : "HS256"
    "typ" : "JWT"
}
```

### Payload

`Payload` 는 토큰에 담을 정보들이 들어 있습니다. 여기서 정보의 조각을 `Claim` 이라 부르고 name / value 의 한 쌍으로 구성됩니다.
`Claim` 의 종류는 크게 세 분류로 구분합니다.

#### 등록된 클레임 (registered)

등록된 클레임은 토큰의 정보들이 담겨 있습니다.

- iss: 토큰 발급자
- sub: 토큰 제목
- aud: 토큰 대상자
- exp: 토큰 만료시간(NumericDate 형식)
- nbf: 토큰 활성 날짜(NumericDate 형식)
- iat: 토큰이 발급된 시간
- jti: 토큰의 고유 식별자

#### 공개 클레임 (public)

JWT를 사용하는 사람들이 마음대로 정의할 수 있습니다. 그러나 출동을 방지하려면 출동 방지 네임스페이스를 포함하는 URL로 정의해야 합니다.

#### 비공개 클레임 (private)

공개 클레임이 아닌 당사자간에 정보를 공유하기 위해 생성된 맞춤 클레임 입니다.

## JSON Web Token은 어떻게 작동하는가?

인증에서 사용자가 자격 증명을 사용하여 성공적으로 로그인하면 JWT가 반환됩니다. 토큰은 자격 증명이므로 보안 문제를 방지하기 위해 세심한 주의를 기울여야 합니다. 토큰을 필요 이상으로 오래 보관해서는 안됩니다.

사용자가 보호된 경로, 리소스에 접근하려고 할 때 마다 사용자는 `Bearer` 스키마를 사용하여 `Authorization` 헤더에서 JWT를 보내야 합니다.

```
Authorization: Bearer <token>
```

## Json Web Token의 장점과 단점은 무엇인가?

### 장점

JWT의 장점은 사용자 인증에 필요한 정보가 토큰 자체에 포함되기 때문에 별도의 인증 저장소가 필요없다는 것 입니다.
MSA 환경에서 서버와 데이터베이스에 의존하지 않는 쉬운 인증 인가 방법을 제공합니다.

- REST API 에 제공 가능
- 디버깅, 관리가 편하다
- 만료일이 토큰에 내장

### 단점

- 토큰은 클라이언트에 저장되어 데이터베이스에서 사용자 정보를 조작하더라도 토큰에 직접 적용할 수 없다
- 토큰이 거의 모든 요청에 대해 전송되므로 데이터 트래픽 크기에 영향을 미칠 수 있다